
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "generated/tutorials/megin/00_signal_space_projection.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_generated_tutorials_megin_00_signal_space_projection.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_generated_tutorials_megin_00_signal_space_projection.py:


.. _tut-artifact-ssp:

Create Signal Space Projectors
==============================

.. include:: ../../../links.inc

.. important::

    This example requires the ``meg_wiki`` package to download the sample dataset. This
    package can be installed with ``pip``:

    .. code-block:: bash

        $ pip install git+https://github.com/fcbg-platforms/meg-wiki

Background on projection
------------------------

Signal-Space Projection (SSP)\ :footcite:p:`ssp_1997` is a way of estimating a
projection matrix to remove noise from a recording by comparing measurements with and
without the signal of interest. An empty-room recording is typically used to estimate
the direction(s) of environmental noise in sensor space. Once the noise vector(s) are
known, you can create an orthogonal hyperplane and construct a projection matrix to
project your recording onto that hyperplane. It should be clear that SSP reduces the
dimensionality of your data and thus sensors will not retain linear independency.

Additional information on projections and on Signal-Space Projection (SSP) can be found
in `MNE's background on projectors and projections`_.

MNE's Python geometric example projecting from 3-dimensional space to the (x, y) plane:

.. GENERATED FROM PYTHON SOURCE LINES 34-68

.. code-block:: Python


    import numpy as np
    from matplotlib import pyplot as plt

    ax = plt.axes(projection="3d")
    ax.view_init(azim=-105, elev=20)
    ax.set(xlabel="x", ylabel="y", zlabel="z", xlim=(-1, 5), ylim=(-1, 5), zlim=(0, 5))

    # plot the vector (3, 2, 5)
    origin = np.zeros((3, 1))
    point = np.array([[3, 2, 5]]).T
    vector = np.hstack([origin, point])
    ax.plot(*vector, color="k")
    ax.plot(*point, color="k", marker="o")

    # project the vector onto the x,y plane and plot it
    xy_projection_matrix = np.array([[1, 0, 0], [0, 1, 0], [0, 0, 0]])
    projected_point = xy_projection_matrix @ point
    projected_vector = xy_projection_matrix @ vector
    ax.plot(*projected_vector, color="C0")
    ax.plot(*projected_point, color="C0", marker="o")

    # add dashed arrow showing projection
    arrow_coords = np.concatenate([point, projected_point - point]).flatten()
    ax.quiver3D(
        *arrow_coords,
        length=0.96,
        arrow_length_ratio=0.1,
        color="C1",
        linewidth=1,
        linestyle="dashed",
    )
    plt.show()




.. image-sg:: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_001.png
   :alt: 00 signal space projection
   :srcset: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 69-79

Default projectors
------------------

The default set of projectors is available `on our GitHub <sample dataset ssp_>`_.
Those projectors were obtained by combining projectors from the wideband PCA and from
the narrowband PCA (bandpass filter between 15 and 18 Hz).
The narrowband PCA improves the correction of the 16.7 Hz artifact, typical from a 15
kV AC railway electrification system.

Let's have a look at the projectors in 68° position when IAS is disabled.

.. GENERATED FROM PYTHON SOURCE LINES 79-86

.. code-block:: Python


    from mne import read_proj

    from meg_wiki.datasets import sample

    projs = read_proj(sample.data_path() / "ssp" / "200123" / "ssp_68_200123_proj.fif")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

        Read a total of 14 projection items:
            ssp_68_magn.fif : PCA-v1 (1 x 306)  idle
            ssp_68_magn.fif : PCA-v2 (1 x 306)  idle
            ssp_68_magn.fif : PCA-v3 (1 x 306)  idle
            ssp_68_magn.fif : PCA-v4 (1 x 306)  idle
            ssp_68_magn.fif : PCA-v5 (1 x 306)  idle
            ssp_68_magn.fif : PCA-v6 (1 x 306)  idle
            ssp_68_magn.fif : PCA-v1 (1 x 306)  idle
            ssp_68_magn.fif : PCA-v2 (1 x 306)  idle
            ssp_68_magn.fif : PCA-v3 (1 x 306)  idle
            ssp_68_grad.fif : PCA-v1 (1 x 306)  idle
            ssp_68_grad.fif : PCA-v2 (1 x 306)  idle
            ssp_68_grad.fif : PCA-v3 (1 x 306)  idle
            ssp_68_grad.fif : PCA-v1 (1 x 306)  idle
            ssp_68_grad.fif : PCA-v2 (1 x 306)  idle




.. GENERATED FROM PYTHON SOURCE LINES 87-89

To visualize the projector as topographic maps, we need information about the sensors
location and orientation. Those information are stored in every raw recording.

.. GENERATED FROM PYTHON SOURCE LINES 89-97

.. code-block:: Python


    from mne.io import read_info

    info = read_info(
        sample.data_path() / "meas_info" / "measurement-info.fif", verbose=False
    )
    info






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <script type="text/javascript">
        // must be `var` (not `const`) because this can get embedded multiple times on a page
    var toggleVisibility = (className) => {

        const elements = document.querySelectorAll(`.${className}`);

        elements.forEach(element => {
            if (element.classList.contains("mne-repr-section-header")) {
                return  // Don't collapse the section header row
            }
            element.classList.toggle("mne-repr-collapsed");
        });

        // trigger caret to rotate
        var sel = `.mne-repr-section-header.${className} > th.mne-repr-section-toggle > button`;
        const button = document.querySelector(sel);
        button.classList.toggle("collapsed");

        // adjust tooltip
        sel = `tr.mne-repr-section-header.${className}`;
        const secHeadRow = document.querySelector(sel);
        secHeadRow.classList.toggle("collapsed");
        secHeadRow.title = secHeadRow.title === "Hide section" ? "Show section" : "Hide section";
    }
    </script>

    <style type="text/css">
        /*
    Styles in this section apply both to the sphinx-built website docs and to notebooks
    rendered in an IDE or in Jupyter. In our web docs, styles here are complemented by
    doc/_static/styles.css and other CSS files (e.g. from the sphinx theme, sphinx-gallery,
    or bootstrap). In IDEs/Jupyter, those style files are unavailable, so only the rules in
    this file apply (plus whatever default styling the IDE applies).
    */
    .mne-repr-table {
        display: inline;  /* prevent using full container width */
    }
    .mne-repr-table tr.mne-repr-section-header > th {
        padding-top: 1rem;
        text-align: left;
        vertical-align: middle;
    }
    .mne-repr-section-toggle > button {
        all: unset;
        display: block;
        height: 1rem;
        width: 1rem;
    }
    .mne-repr-section-toggle > button > svg {
        height: 60%;
    }

    /* transition (rotation) effects on the collapser button */
    .mne-repr-section-toggle > button.collapsed > svg {
        transition: 0.1s ease-out;
        transform: rotate(-90deg);
    }
    .mne-repr-section-toggle > button:not(.collapsed) > svg {
        transition: 0.1s ease-out;
        transform: rotate(0deg);
    }

    /* hide collapsed table rows */
    .mne-repr-collapsed {
        display: none;
    }


    @layer {
        /*
        Selectors in a `@layer` will always be lower-precedence than selectors outside the
        layer. So even though e.g. `div.output_html` is present in the sphinx-rendered
        website docs, the styles here won't take effect there as long as some other rule
        somewhere in the page's CSS targets the same element.

        In IDEs or Jupyter notebooks, though, the CSS files from the sphinx theme,
        sphinx-gallery, and bootstrap are unavailable, so these styles will apply.

        Notes:

        - the selector `.accordion-body` is for MNE Reports
        - the selector `.output_html` is for VSCode's notebook interface
        - the selector `.jp-RenderedHTML` is for Jupyter notebook
        - variables starting with `--theme-` are VSCode-specific.
        - variables starting with `--jp-` are Jupyter styles, *some of which* are also
          available in VSCode. Here we try the `--theme-` variable first, then fall back to
          the `--jp-` ones.
        */
        .mne-repr-table {
            --mne-toggle-color: var(--theme-foreground, var(--jp-ui-font-color1));
            --mne-button-bg-color: var(--theme-button-background, var(--jp-info-color0, var(--jp-content-link-color)));
            --mne-button-fg-color: var(--theme-button-foreground, var(--jp-ui-inverse-font-color0, var(--jp-editor-background)));
            --mne-button-hover-bg-color: var(--theme-button-hover-background, var(--jp-info-color1));
            --mne-button-radius: var(--jp-border-radius, 0.25rem);
        }
        /* chevron position/alignment; in VSCode it looks ok without adjusting */
        .accordion-body .mne-repr-section-toggle > button,
        .jp-RenderedHTML .mne-repr-section-toggle > button {
            padding: 0 0 45% 25% !important;
        }
        /* chevron color; MNE Report doesn't have light/dark mode */
        div.output_html .mne-repr-section-toggle > button > svg > path,
        .jp-RenderedHTML .mne-repr-section-toggle > button > svg > path {
            fill: var(--mne-toggle-color);
        }
        .accordion-body .mne-ch-names-btn,
        div.output_html .mne-ch-names-btn,
        .jp-RenderedHTML .mne-ch-names-btn {
            -webkit-border-radius: var(--mne-button-radius);
            -moz-border-radius: var(--mne-button-radius);
            border-radius: var(--mne-button-radius);
            border: none;
            background-image: none;
            background-color: var(--mne-button-bg-color);
            color: var(--mne-button-fg-color);
            font-size: inherit;
            min-width: 1.5rem;
            padding: 0.25rem;
            text-align: center;
            text-decoration: none;
        }
        .accordion-body .mne-ch-names-btn:hover,
        div.output_html .mne.ch-names-btn:hover,
        .jp-RenderedHTML .mne-ch-names-btn:hover {
            background-color: var(--mne-button-hover-bg-color);
            text-decoration: underline;
        }
        .accordion-body .mne-ch-names-btn:focus-visible,
        div.output_html .mne-ch-names-btn:focus-visible,
        .jp-RenderedHTML .mne-ch-names-btn:focus-visible {
            outline: 0.1875rem solid var(--mne-button-bg-color) !important;
            outline-offset: 0.1875rem !important;
        }
    }
    </style>



    <table class="table mne-repr-table">
    







    <tr class="mne-repr-section-header general-b7bc3d93-4762-4526-bc02-3a7bfde80568"
         title="Hide section" 
        onclick="toggleVisibility('general-b7bc3d93-4762-4526-bc02-3a7bfde80568')">
        <th class="mne-repr-section-toggle">
            <button >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
            </button>
        </th>
        <th colspan="2">
            <strong>General</strong>
        </th>
    </tr>


    <tr class="repr-element general-b7bc3d93-4762-4526-bc02-3a7bfde80568 ">
        <td class="mne-repr-section-toggle"></td>
        <td>MNE object type</td>
        <td>Info</td>
    </tr>
    <tr class="repr-element general-b7bc3d93-4762-4526-bc02-3a7bfde80568 ">
        <td class="mne-repr-section-toggle"></td>
        <td>Measurement date</td>
    
        <td>2000-01-01 at 00:00:00 UTC</td>
    
    </tr>
    <tr class="repr-element general-b7bc3d93-4762-4526-bc02-3a7bfde80568 ">
        <td class="mne-repr-section-toggle"></td>
        <td>Participant</td>
    
    
    
    </tr>
    <tr class="repr-element general-b7bc3d93-4762-4526-bc02-3a7bfde80568 ">
        <td class="mne-repr-section-toggle"></td>
        <td>Experimenter</td>
    
        <td>mne_anonymize</td>
    
    </tr>
    







    <tr class="mne-repr-section-header acquisition-3fdc68d4-fec6-44ca-b3a7-bff5fb46ce77"
         title="Hide section" 
        onclick="toggleVisibility('acquisition-3fdc68d4-fec6-44ca-b3a7-bff5fb46ce77')">
        <th class="mne-repr-section-toggle">
            <button >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
            </button>
        </th>
        <th colspan="2">
            <strong>Acquisition</strong>
        </th>
    </tr>









    <tr class="repr-element acquisition-3fdc68d4-fec6-44ca-b3a7-bff5fb46ce77 ">
        <td class="mne-repr-section-toggle"></td>
        <td>Sampling frequency</td>
        <td>1000.00 Hz</td>
    </tr>



    







    <tr class="mne-repr-section-header channels-21a4bcaa-c289-46a7-af65-218835560c59"
         title="Hide section" 
        onclick="toggleVisibility('channels-21a4bcaa-c289-46a7-af65-218835560c59')">
        <th class="mne-repr-section-toggle">
            <button >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
            </button>
        </th>
        <th colspan="2">
            <strong>Channels</strong>
        </th>
    </tr>


    
    <tr class="repr-element channels-21a4bcaa-c289-46a7-af65-218835560c59 ">
        <td class="mne-repr-section-toggle"></td>
        <td>Magnetometers</td>
        <td>
            <button class="mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm" onclick="alert('Good Magnetometers:\n\nMEG0111, MEG0121, MEG0131, MEG0141, MEG0211, MEG0221, MEG0231, MEG0241, MEG0311, MEG0321, MEG0331, MEG0341, MEG0411, MEG0421, MEG0431, MEG0441, MEG0511, MEG0521, MEG0531, MEG0541, MEG0611, MEG0621, MEG0631, MEG0641, MEG0711, MEG0721, MEG0731, MEG0741, MEG0811, MEG0821, MEG0911, MEG0921, MEG0931, MEG0941, MEG1011, MEG1021, MEG1031, MEG1041, MEG1111, MEG1121, MEG1131, MEG1141, MEG1211, MEG1221, MEG1231, MEG1241, MEG1311, MEG1321, MEG1331, MEG1341, MEG1411, MEG1421, MEG1431, MEG1441, MEG1511, MEG1521, MEG1531, MEG1541, MEG1611, MEG1621, MEG1631, MEG1641, MEG1711, MEG1721, MEG1731, MEG1741, MEG1811, MEG1821, MEG1831, MEG1841, MEG1911, MEG1921, MEG1931, MEG1941, MEG2011, MEG2021, MEG2031, MEG2041, MEG2111, MEG2121, MEG2131, MEG2141, MEG2211, MEG2221, MEG2231, MEG2241, MEG2311, MEG2321, MEG2331, MEG2341, MEG2411, MEG2421, MEG2431, MEG2441, MEG2511, MEG2521, MEG2531, MEG2541, MEG2611, MEG2621, MEG2631, MEG2641')" title="(Click to open in popup)&#13;&#13;MEG0111, MEG0121, MEG0131, MEG0141, MEG0211, MEG0221, MEG0231, MEG0241, MEG0311, MEG0321, MEG0331, MEG0341, MEG0411, MEG0421, MEG0431, MEG0441, MEG0511, MEG0521, MEG0531, MEG0541, MEG0611, MEG0621, MEG0631, MEG0641, MEG0711, MEG0721, MEG0731, MEG0741, MEG0811, MEG0821, MEG0911, MEG0921, MEG0931, MEG0941, MEG1011, MEG1021, MEG1031, MEG1041, MEG1111, MEG1121, MEG1131, MEG1141, MEG1211, MEG1221, MEG1231, MEG1241, MEG1311, MEG1321, MEG1331, MEG1341, MEG1411, MEG1421, MEG1431, MEG1441, MEG1511, MEG1521, MEG1531, MEG1541, MEG1611, MEG1621, MEG1631, MEG1641, MEG1711, MEG1721, MEG1731, MEG1741, MEG1811, MEG1821, MEG1831, MEG1841, MEG1911, MEG1921, MEG1931, MEG1941, MEG2011, MEG2021, MEG2031, MEG2041, MEG2111, MEG2121, MEG2131, MEG2141, MEG2211, MEG2221, MEG2231, MEG2241, MEG2311, MEG2321, MEG2331, MEG2341, MEG2411, MEG2421, MEG2431, MEG2441, MEG2511, MEG2521, MEG2531, MEG2541, MEG2611, MEG2621, MEG2631, MEG2641">
                102
            </button>

        
        </td>
    </tr>

    
    <tr class="repr-element channels-21a4bcaa-c289-46a7-af65-218835560c59 ">
        <td class="mne-repr-section-toggle"></td>
        <td>Gradiometers</td>
        <td>
            <button class="mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm" onclick="alert('Good Gradiometers:\n\nMEG0112, MEG0113, MEG0122, MEG0123, MEG0132, MEG0133, MEG0142, MEG0143, MEG0212, MEG0213, MEG0222, MEG0223, MEG0232, MEG0233, MEG0242, MEG0243, MEG0312, MEG0313, MEG0322, MEG0323, MEG0332, MEG0333, MEG0342, MEG0343, MEG0412, MEG0413, MEG0422, MEG0423, MEG0432, MEG0433, MEG0442, MEG0443, MEG0512, MEG0513, MEG0522, MEG0523, MEG0532, MEG0533, MEG0542, MEG0543, MEG0612, MEG0613, MEG0622, MEG0623, MEG0632, MEG0633, MEG0642, MEG0643, MEG0712, MEG0713, MEG0722, MEG0723, MEG0732, MEG0733, MEG0742, MEG0743, MEG0812, MEG0813, MEG0822, MEG0823, MEG0912, MEG0913, MEG0922, MEG0923, MEG0932, MEG0933, MEG0942, MEG0943, MEG1012, MEG1013, MEG1022, MEG1023, MEG1032, MEG1033, MEG1042, MEG1043, MEG1112, MEG1113, MEG1122, MEG1123, MEG1132, MEG1133, MEG1142, MEG1143, MEG1212, MEG1213, MEG1222, MEG1223, MEG1232, MEG1233, MEG1242, MEG1243, MEG1312, MEG1313, MEG1322, MEG1323, MEG1332, MEG1333, MEG1342, MEG1343, MEG1412, MEG1413, MEG1422, MEG1423, MEG1432, MEG1433, MEG1442, MEG1443, MEG1512, MEG1513, MEG1522, MEG1523, MEG1532, MEG1533, MEG1542, MEG1543, MEG1612, MEG1613, MEG1622, MEG1623, MEG1632, MEG1633, MEG1642, MEG1643, MEG1712, MEG1713, MEG1722, MEG1723, MEG1732, MEG1733, MEG1742, MEG1743, MEG1812, MEG1813, MEG1822, MEG1823, MEG1832, MEG1833, MEG1842, MEG1843, MEG1912, MEG1913, MEG1922, MEG1923, MEG1932, MEG1933, MEG1942, MEG1943, MEG2012, MEG2013, MEG2022, MEG2023, MEG2032, MEG2033, MEG2042, MEG2043, MEG2112, MEG2113, MEG2122, MEG2123, MEG2132, MEG2133, MEG2142, MEG2143, MEG2212, MEG2213, MEG2222, MEG2223, MEG2232, MEG2233, MEG2242, MEG2243, MEG2312, MEG2313, MEG2322, MEG2323, MEG2332, MEG2333, MEG2342, MEG2343, MEG2412, MEG2413, MEG2422, MEG2423, MEG2432, MEG2433, MEG2442, MEG2443, MEG2512, MEG2513, MEG2522, MEG2523, MEG2532, MEG2533, MEG2542, MEG2543, MEG2612, MEG2613, MEG2622, MEG2623, MEG2632, MEG2633, MEG2642, MEG2643')" title="(Click to open in popup)&#13;&#13;MEG0112, MEG0113, MEG0122, MEG0123, MEG0132, MEG0133, MEG0142, MEG0143, MEG0212, MEG0213, MEG0222, MEG0223, MEG0232, MEG0233, MEG0242, MEG0243, MEG0312, MEG0313, MEG0322, MEG0323, MEG0332, MEG0333, MEG0342, MEG0343, MEG0412, MEG0413, MEG0422, MEG0423, MEG0432, MEG0433, MEG0442, MEG0443, MEG0512, MEG0513, MEG0522, MEG0523, MEG0532, MEG0533, MEG0542, MEG0543, MEG0612, MEG0613, MEG0622, MEG0623, MEG0632, MEG0633, MEG0642, MEG0643, MEG0712, MEG0713, MEG0722, MEG0723, MEG0732, MEG0733, MEG0742, MEG0743, MEG0812, MEG0813, MEG0822, MEG0823, MEG0912, MEG0913, MEG0922, MEG0923, MEG0932, MEG0933, MEG0942, MEG0943, MEG1012, MEG1013, MEG1022, MEG1023, MEG1032, MEG1033, MEG1042, MEG1043, MEG1112, MEG1113, MEG1122, MEG1123, MEG1132, MEG1133, MEG1142, MEG1143, MEG1212, MEG1213, MEG1222, MEG1223, MEG1232, MEG1233, MEG1242, MEG1243, MEG1312, MEG1313, MEG1322, MEG1323, MEG1332, MEG1333, MEG1342, MEG1343, MEG1412, MEG1413, MEG1422, MEG1423, MEG1432, MEG1433, MEG1442, MEG1443, MEG1512, MEG1513, MEG1522, MEG1523, MEG1532, MEG1533, MEG1542, MEG1543, MEG1612, MEG1613, MEG1622, MEG1623, MEG1632, MEG1633, MEG1642, MEG1643, MEG1712, MEG1713, MEG1722, MEG1723, MEG1732, MEG1733, MEG1742, MEG1743, MEG1812, MEG1813, MEG1822, MEG1823, MEG1832, MEG1833, MEG1842, MEG1843, MEG1912, MEG1913, MEG1922, MEG1923, MEG1932, MEG1933, MEG1942, MEG1943, MEG2012, MEG2013, MEG2022, MEG2023, MEG2032, MEG2033, MEG2042, MEG2043, MEG2112, MEG2113, MEG2122, MEG2123, MEG2132, MEG2133, MEG2142, MEG2143, MEG2212, MEG2213, MEG2222, MEG2223, MEG2232, MEG2233, MEG2242, MEG2243, MEG2312, MEG2313, MEG2322, MEG2323, MEG2332, MEG2333, MEG2342, MEG2343, MEG2412, MEG2413, MEG2422, MEG2423, MEG2432, MEG2433, MEG2442, MEG2443, MEG2512, MEG2513, MEG2522, MEG2523, MEG2532, MEG2533, MEG2542, MEG2543, MEG2612, MEG2613, MEG2622, MEG2623, MEG2632, MEG2633, MEG2642, MEG2643">
                204
            </button>

        
        </td>
    </tr>


    <tr class="repr-element channels-21a4bcaa-c289-46a7-af65-218835560c59 ">
        <td class="mne-repr-section-toggle"></td>
        <td>Head & sensor digitization</td>
    
        <td>Not available</td>
    
    </tr>
    







    <tr class="mne-repr-section-header filters-9b78abca-f4fd-47b7-97b6-d8041d30a4fc"
         title="Hide section" 
        onclick="toggleVisibility('filters-9b78abca-f4fd-47b7-97b6-d8041d30a4fc')">
        <th class="mne-repr-section-toggle">
            <button >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
            </button>
        </th>
        <th colspan="2">
            <strong>Filters</strong>
        </th>
    </tr>


    <tr class="repr-element filters-9b78abca-f4fd-47b7-97b6-d8041d30a4fc ">
        <td class="mne-repr-section-toggle"></td>
        <td>Highpass</td>
        <td>0.10 Hz</td>
    </tr>


    <tr class="repr-element filters-9b78abca-f4fd-47b7-97b6-d8041d30a4fc ">
        <td class="mne-repr-section-toggle"></td>
        <td>Lowpass</td>
        <td>330.00 Hz</td>
    </tr>


    <tr class="repr-element filters-9b78abca-f4fd-47b7-97b6-d8041d30a4fc ">
        <td class="mne-repr-section-toggle"></td>
        <td>Projections</td>
        <td>
        
            ssp_68_magn.fif : PCA-v1 (off)
            <br />
        
            ssp_68_magn.fif : PCA-v2 (off)
            <br />
        
            ssp_68_magn.fif : PCA-v3 (off)
            <br />
        
            ssp_68_magn.fif : PCA-v4 (off)
            <br />
        
            ssp_68_magn.fif : PCA-v5 (off)
            <br />
        
            ssp_68_magn.fif : PCA-v6 (off)
            <br />
        
            ssp_68_magn.fif : PCA-v1 (off)
            <br />
        
            ssp_68_magn.fif : PCA-v2 (off)
            <br />
        
            ssp_68_magn.fif : PCA-v3 (off)
            <br />
        
            ssp_68_grad.fif : PCA-v1 (off)
            <br />
        
            ssp_68_grad.fif : PCA-v2 (off)
            <br />
        
            ssp_68_grad.fif : PCA-v3 (off)
            <br />
        
            ssp_68_grad.fif : PCA-v1 (off)
            <br />
        
            ssp_68_grad.fif : PCA-v2 (off)
        
        
        </td>
    </tr>

    </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 98-114

.. code-block:: Python


    from matplotlib import pyplot as plt

    f, ax = plt.subplots(2, 3, figsize=(6, 6))
    for k, proj in enumerate(projs[0:6]):
        proj.plot_topomap(info, axes=ax[k // 3, k % 3])
        ax[k // 3, k % 3].set_title(f"PCA-v{k + 1}")
    plt.suptitle("Magnetometers - Wideband PCA")

    f, ax = plt.subplots(1, 3, figsize=(6, 6))
    for k, proj in enumerate(projs[6:9]):
        proj.plot_topomap(info, axes=ax[k])
        ax[k].set_title(f"PCA-v{k + 1}")
    plt.suptitle("Magnetometers - Narrowband PCA")
    plt.show()




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_002.png
         :alt: Magnetometers - Wideband PCA, PCA-v1, PCA-v2, PCA-v3, PCA-v4, PCA-v5, PCA-v6
         :srcset: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_003.png
         :alt: Magnetometers - Narrowband PCA, PCA-v1, PCA-v2, PCA-v3
         :srcset: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_003.png
         :class: sphx-glr-multi-img





.. GENERATED FROM PYTHON SOURCE LINES 115-131

.. code-block:: Python


    from matplotlib import pyplot as plt

    f, ax = plt.subplots(1, 3, figsize=(6, 6))
    for k, proj in enumerate(projs[9:12]):
        proj.plot_topomap(info, axes=ax[k])
        ax[k].set_title(f"PCA-v{k + 1}")
    plt.suptitle("Gradiometers - Wideband PCA")

    f, ax = plt.subplots(1, 2, figsize=(6, 6))
    for k, proj in enumerate(projs[12:14]):
        proj.plot_topomap(info, axes=ax[k])
        ax[k].set_title(f"PCA-v{k + 1}")
    plt.suptitle("Gradiometers - Narrowband PCA")
    plt.show()




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_004.png
         :alt: Gradiometers - Wideband PCA, PCA-v1, PCA-v2, PCA-v3
         :srcset: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_004.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_005.png
         :alt: Gradiometers - Narrowband PCA, PCA-v1, PCA-v2
         :srcset: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_005.png
         :class: sphx-glr-multi-img





.. GENERATED FROM PYTHON SOURCE LINES 132-140

Empty room recording
--------------------

Projectors are determined from an empty-room recording. They are specific to a gantry
position (up-right 68°, up-right 60°, supine 0°) and to an
:ref:`meg-settings:Internal Active Shielding (IAS)` state (``ON`` or ``OFF``). The
empty-room recording loaded below was measured with the gantry in the 68° position and
with IAS disabled.

.. GENERATED FROM PYTHON SOURCE LINES 140-149

.. code-block:: Python


    from mne.io import read_raw_fif

    raw = read_raw_fif(
        sample.data_path() / "empty-room" / "empty-room-raw.fif", verbose=False
    )
    raw.del_proj("all")  # remove the default projectors
    raw.info["bads"] = ["MEG1343"]  # bad channel with flux jumps








.. GENERATED FROM PYTHON SOURCE LINES 150-156

Noise level
~~~~~~~~~~~

The power spectral density can be used to visualize the noise level. See
:footcite:t:`msr-noise_2013` and this `MNE-Python example`_ for additional
information.

.. GENERATED FROM PYTHON SOURCE LINES 156-167

.. code-block:: Python


    raw.compute_psd(verbose=False).plot(
        average=True,
        spatial_colors=False,
        dB=False,
        xscale="log",
        picks="data",
        exclude="bads",
    )
    plt.show()




.. image-sg:: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_006.png
   :alt: Gradiometers, Magnetometers
   :srcset: /generated/tutorials/megin/images/sphx_glr_00_signal_space_projection_006.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Plotting power spectral density (dB=False).




.. GENERATED FROM PYTHON SOURCE LINES 168-174

References
----------

.. footbibliography::

.. _MNE-Python example: https://mne.tools/stable/auto_examples/visualization/sensor_noise_level.html


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 17.013 seconds)

**Estimated memory usage:**  983 MB


.. _sphx_glr_download_generated_tutorials_megin_00_signal_space_projection.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: 00_signal_space_projection.ipynb <00_signal_space_projection.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: 00_signal_space_projection.py <00_signal_space_projection.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: 00_signal_space_projection.zip <00_signal_space_projection.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
